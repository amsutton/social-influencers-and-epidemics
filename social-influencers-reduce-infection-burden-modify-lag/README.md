# Social influencers reduce infection burden and modify epidemic lag in group-structured populations 

This analysis is primarily built in the Julia programming language using Agents.jl to implement and run agent-based models. The visualization of the results is completed in R programming language using primarily ggplot2.

Below, we briefly describe how to reproduce this analysis in Julia and in R.


## Technical Specifications


### Run the agent-based model simulations in ```Julia``` using ```Agents.jl```

The first part of this project's code base uses the [Julia Language](https://julialang.org/) and
[DrWatson](https://juliadynamics.github.io/DrWatson.jl/stable/)
to make a reproducible scientific project named

> social_influence_epi

It is authored by Aja Sutton.

To (locally) reproduce this project, do the following:

0. Download this code base. Notice that raw data are typically not included in the
   git-history and may need to be downloaded independently.
1. Open a Julia console and do:
   ```
   julia> using Pkg
   julia> Pkg.add("DrWatson") # install globally, for using `quickactivate`
   julia> Pkg.activate("path/to/this/project")
   julia> Pkg.instantiate()
   ```

This will install all necessary packages for you to be able to run the scripts and
everything should work out of the box, including correctly finding local paths.

You may notice that most scripts start with the commands:
```julia
using DrWatson
@quickactivate "social_influence_epi"
```
which auto-activate the project and enable local path handling from DrWatson.

From there, we have set up the analysis to run on Stanford's Sherlock cluster computing system, a Linux-based cluster (slurm). The code for running the simulatiosn on cluster computing is found in ```./src/slurm```. If you wish to run trials locally, see: ```src/baseline_analysis_forlocal.sh```.

In the paper, Scenario 1 results are generated by ```baseline.jl```, and Secnarios 2 and 3 resulst are generated by ```model_bidirectional_twogroup_influence.jl```. To examine the actual parametrisations, and the models themselves, see: ```./code/models```. The two ```.jl``` scripts here are identical models, except that the ```baseline.jl``` model omits the effects of social influencers present in ```model_bidirectional_twogroup_influence.jl```, i.e., they are functionally the same model, where one has the influencer dynamic turned off. They produce large CSV files (10 files per homophily/out-group aversion parametrisation, with 100 runs in each to equal 1000 full runs -- this is specified in this way to ease computation with parallelisation).

Warning: this part of the analysis is extremely computationally intense, and can take a long time! We ran sets of calls to the cluster to ease computational demand. With this in mind, we will share the data cleaned in ```R``` (described below) to facilitate the reproduction of the analyses and visualisation.

### Clean, analyze, and visualize the generated data in ```R```

The analyses and results in this paper can be reproduced by opening the ```R``` project file: ```social_influence.Rproj```. Assuming you have run the simulation code, you will have the data saved appropriately. If you are not running the Julia code, you must assure you have the cleaned objects in the ```/data``` folder (these are available at [LINK FORTHCOMING UPON PUBLICATION]. 

If you are cleaning the raw simulation data, run the code in the script: ```code/r_code/00a_run_from_source.R```. If you are processing previously cleaned code, open up ```00a_run_from_source.R``` and run the code, omitting line 18 (the processing script). 

This process should generate behaviour and infection curves, as well as analytical results, tables, and figures used in the paper.



If you have questions or comments, please get in touch!




